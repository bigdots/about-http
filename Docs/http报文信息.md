<!-- TOC -->

- [http报文信息](#http报文信息)
    - [HTTP 报文](#http-报文)
    - [使用编码](#使用编码)
        - [内容编码](#内容编码)
        - [分块传输编码（Chunked Transfer Coding)](#分块传输编码chunked-transfer-coding)
    - [多部分对象集合](#多部分对象集合)
    - [内容协商](#内容协商)

<!-- /TOC -->
# http报文信息

报文是箱子，实体是货物。

+ 报文(message):

    是 HTTP 通信中的基本单位，由 8 位组字节流(octet sequence，其中 octet 为 8 个比特)组成，通过 HTTP 通信传输。
+ 实体(entity):

    作为请求或响应的有效载荷数据(补充项)被传输，其内容由实体首部和实体主体组成。

通常，报文主体等于实体主体。只有当传输中进行编码操作时，实体主体的内容发生变化，才导致它和报文主体产生差异。

## HTTP 报文

> 用于 HTTP 协议交互的信息被称为 HTTP 报文。HTTP 报文本身是由多行(用 CR+LF 作换行符)数据构成的字符串文本。

请求端(客户端)的 HTTP 报文叫做请求报文，响应端(服务器端)的叫做响应报文。

HTTP 报文大致可分为报文首部和报文主体两块。两者由最初出现的空行(CR+LF)来划分。通常，并不一定要有报文主体。

首部内容：

请求行／状态行

首部字段（通用首部、请求首部、响应首部和实体首部。）

其他（Cookie 等）

## 使用编码

+ 通过在传输时编码，能有效地处理大量的访问请求，提升传输速率
+ 会消耗更多的 CPU 等 资源。

实现方式及原理：
+ 服务端根据指定方式对实体内容进行编码，传输到客户端
+ 客户端再编码规则对实体内容进行解码

### 内容编码

内容编码指明应用在实体内容上的编码格式，并保持实体信息原样压缩。

常用的内容编码：
+ gzip(GNU zip)
+ compress(UNIX 系统的标准压缩)
+ deflate(zlib)
+ identity(不进行编码)

### 分块传输编码（Chunked Transfer Coding)

把实体主体分块的功能称为分块传输编码。每一块都会用十六进制来标记块的大小，而实体主体的最后一块会使用“0(CR+LF)”来标记。

## 多部分对象集合

允许报文主体内可含有多类型实体。

使用时需要在首部字段里加上 Content-type。

+ multipart/form-data

    在 Web 表单文件上传时使用。

+ multipart/byteranges

   可以指定资源的字节范围，响应报文包含了多个范围的内容时使用， 态码 206(Partial Content，部分内容)。

## 内容协商

> 内容协商机制是指客户端和服务器端就响应的资源内容进行交涉，然后提供给客户端最为适合的资源。内容
协商会以响应资源的语言、字符集、编码方式等作为判断的基准。


这些基准可以在报文中通过首部字段指定：

`Accept/Accept-Charset/Accept-Encoding/Accept-Language/Content-Language`

1. 服务器驱动协商

    服务器端以请求的首部字段为参考，在服务器端自动处理
2. 客户端驱动协商

    用户从客户端显示的可选项列表中手动选择。

3. 透明协商

    服务器驱动和客户端驱动的结合体